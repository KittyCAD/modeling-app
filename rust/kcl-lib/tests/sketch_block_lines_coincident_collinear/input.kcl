@settings(experimentalFeatures = allow)

// Test line-line coincident constraint (collinear)
// This tests making two line segments collinear using coincident([line1, line2])
s = sketch(on = XY) {
  // Create first line segment
  line1 = sketch2::line(start = [var 0mm, var 0mm], end = [var 10mm, var 0mm])
  
  // Constrain line1 endpoints
  line1.start.at[0] == 0
  line1.start.at[1] == 0
  line1.end.at[0] == 10
  line1.end.at[1] == 0
  
  // Create second line segment that should become collinear with line1
  line2 = sketch2::line(start = [var, var], end = [var, var])
  
  // Constrain line2's end point to a known position
  line2.end.at[0] == 20
  line2.end.at[1] == 0
  
  // Make the two lines collinear using coincident constraint
  // This should create both a parallel constraint and a perpendicular distance of zero
  sketch2::coincident([line1, line2])
  
  // Constrain line2's start point x-coordinate to verify collinearity
  // Since they're collinear and line1 is horizontal, line2.start.y should be 0
  line2.start.at[0] == 10
}

// Verify line1 is horizontal at y=0
assert(s.line1.start.at[0], isEqualTo = 0, tolerance = 0.000001)
assert(s.line1.start.at[1], isEqualTo = 0, tolerance = 0.000001)
assert(s.line1.end.at[0], isEqualTo = 10, tolerance = 0.000001)
assert(s.line1.end.at[1], isEqualTo = 0, tolerance = 0.000001)

// Verify line2 is collinear with line1 (same y-coordinate)
assert(s.line2.start.at[0], isEqualTo = 10, tolerance = 0.000001)
assert(s.line2.start.at[1], isEqualTo = 0, tolerance = 0.000001)
assert(s.line2.end.at[0], isEqualTo = 20, tolerance = 0.000001)
assert(s.line2.end.at[1], isEqualTo = 0, tolerance = 0.000001)
